{"ast":null,"code":"import _asyncToGenerator from \"/Users/alyson/codelab/leaflet-draw/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"/Users/alyson/codelab/leaflet-draw/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _jsxFileName = \"/Users/alyson/codelab/leaflet-draw/src/components/DisplayPosition.js\",\n    _this = this,\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport _regeneratorRuntime from \"/Users/alyson/codelab/leaflet-draw/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator/index.js\";\nimport { useCallback, useState, useEffect } from \"react\";\nimport L from \"leaflet\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar Address = function Address(_ref) {\n  _s();\n\n  var map = _ref.map,\n      position = _ref.position;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      address = _useState2[0],\n      setAddress = _useState2[1];\n\n  var fetchAddress = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(lat, lon) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              axios(\"https://nominatim.openstreetmap.org/reverse\", {\n                params: {\n                  format: \"jsonv2\",\n                  lat: lat,\n                  lon: lon\n                }\n              }).then(function (res) {\n                setAddress(res.data);\n              }).catch(console.error);\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function fetchAddress(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var onMoveEnd = useCallback(function () {\n    fetchAddress(position.lat, position.lng);\n  }, [position.lat, position.lng]);\n  useEffect(function () {\n    map.on(\"moveend\", onMoveEnd);\n    return function () {\n      map.off(\"moveend\", onMoveEnd);\n    };\n  }, [map, onMoveEnd]);\n  return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: [\"Address: \", address ? address.display_name : \"Unavailable\"]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 33,\n    columnNumber: 10\n  }, _this);\n};\n\n_s(Address, \"kSmrbxchRjmT41VYgPHVYcHbDeA=\");\n\n_c = Address;\n\nvar DisplayPosition = function DisplayPosition(_ref3) {\n  _s2();\n\n  var map = _ref3.map,\n      center = _ref3.center,\n      zoom = _ref3.zoom;\n\n  var _useState3 = useState(map.getCenter()),\n      _useState4 = _slicedToArray(_useState3, 2),\n      position = _useState4[0],\n      setPosition = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      search = _useState6[0],\n      setSearch = _useState6[1];\n\n  var _useState7 = useState(null),\n      _useState8 = _slicedToArray(_useState7, 2),\n      response = _useState8[0],\n      setResponse = _useState8[1];\n\n  var onClick = useCallback(function () {\n    map.setView(center, zoom);\n  }, [map, center, zoom]);\n  var onMove = useCallback(function () {\n    setPosition(map.getCenter());\n  }, [map]);\n  useEffect(function () {\n    map.on(\"move\", onMove);\n    return function () {\n      map.off(\"move\", onMove);\n    };\n  }, [map, onMove]);\n\n  var handleSearch = function handleSearch(e) {\n    setSearch(e.target.value);\n    axios.get('https://nominatim.openstreetmap.org/search', {\n      params: {\n        country: e.target.value,\n        format: 'json',\n        limit: 5,\n        polygon_geojson: 1\n      }\n    }).then(function (result) {\n      setResponse(result.data);\n      return result;\n    }).catch(function (error) {\n      return console.log(error);\n    });\n  };\n\n  var handleCountrySelect = function handleCountrySelect(country) {\n    L.geoJSON(country.geojson, {\n      color: 'lightgreen'\n    }).addTo(map);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Actual center\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: 'text',\n      value: search,\n      onChange: handleSearch\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, _this), response && response.map(function (country) {\n      return /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: function onClick() {\n          return handleCountrySelect(country);\n        },\n        children: country.display_name\n      }, country.display_name, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 17\n      }, _this);\n    }), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"latitude: \", position.lat.toFixed(4), \", longitude:\", \" \", position.lng.toFixed(4), \" \"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(Address, {\n      map: map,\n      position: position\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onClick,\n        children: \"reset\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, _this);\n};\n\n_s2(DisplayPosition, \"6Q71hKp97yCswrkNeXVo0DBkOmk=\");\n\n_c2 = DisplayPosition;\nexport default DisplayPosition;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Address\");\n$RefreshReg$(_c2, \"DisplayPosition\");","map":{"version":3,"names":["useCallback","useState","useEffect","L","axios","Address","map","position","address","setAddress","fetchAddress","lat","lon","params","format","then","res","data","catch","console","error","onMoveEnd","lng","on","off","display_name","DisplayPosition","center","zoom","getCenter","setPosition","search","setSearch","response","setResponse","onClick","setView","onMove","handleSearch","e","target","value","get","country","limit","polygon_geojson","result","log","handleCountrySelect","geoJSON","geojson","color","addTo","toFixed"],"sources":["/Users/alyson/codelab/leaflet-draw/src/components/DisplayPosition.js"],"sourcesContent":["import { useCallback, useState, useEffect } from \"react\";\r\nimport L from \"leaflet\";\r\nimport axios from \"axios\";\r\n\r\nconst Address = ({ map, position }) => {\r\n  const [address, setAddress] = useState(null);\r\n\r\n  const fetchAddress = async (lat, lon) => {\r\n    axios(\"https://nominatim.openstreetmap.org/reverse\", {\r\n      params: {\r\n        format: \"jsonv2\",\r\n        lat: lat,\r\n        lon: lon\r\n      }\r\n    })\r\n      .then((res) => {\r\n        setAddress(res.data);\r\n      })\r\n      .catch(console.error);\r\n  };\r\n\r\n  const onMoveEnd = useCallback(() => {\r\n    fetchAddress(position.lat, position.lng);\r\n  }, [position.lat, position.lng]);\r\n\r\n  useEffect(() => {\r\n    map.on(\"moveend\", onMoveEnd);\r\n    return () => {\r\n      map.off(\"moveend\", onMoveEnd);\r\n    };\r\n  }, [map, onMoveEnd]);\r\n\r\n  return <p>Address: {address ? address.display_name : \"Unavailable\"}</p>;\r\n};\r\n\r\nconst DisplayPosition = ({ map, center, zoom }) => {\r\n  const [position, setPosition] = useState(map.getCenter());\r\n  const [search, setSearch] = useState('');\r\n  const [response, setResponse] = useState(null)\r\n\r\n  const onClick = useCallback(() => {\r\n    map.setView(center, zoom);\r\n  }, [map, center, zoom]);\r\n\r\n  const onMove = useCallback(() => {\r\n    setPosition(map.getCenter());\r\n  }, [map]);\r\n\r\n  useEffect(() => {\r\n    map.on(\"move\", onMove);\r\n    return () => {\r\n      map.off(\"move\", onMove);\r\n    };\r\n  }, [map, onMove]);\r\n\r\n\r\n  const handleSearch = (e) => {\r\n    setSearch(e.target.value);\r\n\r\n      axios.get('https://nominatim.openstreetmap.org/search', {\r\n        params: {\r\n          country: e.target.value,\r\n          format: 'json',\r\n          limit: 5,\r\n          polygon_geojson: 1\r\n        }\r\n      }).then((result) => {\r\n        setResponse(result.data)\r\n        return result;\r\n      }).catch(error => console.log(error))\r\n\r\n  }\r\n\r\n  const handleCountrySelect = (country) => {\r\n    L.geoJSON(country.geojson, {color: 'lightgreen'}).addTo(map);\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h3>Actual center</h3>\r\n      <input type={'text'} value={search} onChange={handleSearch} />\r\n      <br/>\r\n      {response && response.map((country) => {\r\n        return (<button onClick={()=> handleCountrySelect(country)} key={country.display_name}>\r\n          {country.display_name}\r\n        </button>)\r\n      })}\r\n      <p>\r\n        latitude: {position.lat.toFixed(4)}, longitude:{\" \"}\r\n        {position.lng.toFixed(4)}{\" \"}\r\n      </p>\r\n      <Address map={map} position={position} />\r\n      <p>\r\n        <button onClick={onClick}>reset</button>\r\n      </p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DisplayPosition;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}